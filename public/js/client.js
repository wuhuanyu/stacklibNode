!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,n){"use strict";var r=n(1),o=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(r),c={method:"GET",cache:"default"},u=window.cacheClient,i=(u.pushCacheData,u.pushNewsRecent,u.checkExists,u.pushOtherRecent,u.checkFieldsExsits),a=u.cache,s=(u.getData,window.cacheClient);window.client=function(){var t=function(t,n,r,u){if(console.log(n),s.cache[t].recent[n].length<r)return fetch(o.constructRecentNewsUrl(t,n,r,["id"]),c).then(function(r){if(r.ok)return r.json().then(function(r){r.data.map(function(t){return t._id}).forEach(function(e){return s.pushNewsRecent(t,n,e)});var o=s.cache[t].recent[n];return Promise.all(o.map(function(n){return e(t,n,u)}))})});var i=s.cache[t].recent[n];return Promise.all(i.map(function(n){return e(t,n,u)}))},e=function(t,e,n){var r=n.filter(function(n){return!i(t,e,n)});return 0===r.length?Promise.resolve(s.getData(t,e)):fetch(o.constructIdNewsUrl(t,e,r),c).then(function(n){return n.ok?n.json().then(function(n){if(1===n.count)return s.pushCacheData(t,n.data[0]),s.getData(t,e)}):Promise.reject(new Error("[getNewsById] "+n.status))})},n=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,c=arguments[3],u=a[t].tags[n];return r<=u.length?Promise.all(u.map(function(n){return e(t,n,c)})):fetch(o.constructTagNewsUrl(t,n,r,["id"])).then(function(r){return r.ok?r.json().then(function(r){r.data.map(function(t){return t._id}).forEach(function(e){return s.pushNewsByTag(t,n,e)});var o=a[t].tags[n];return Promise.all(o.map(function(n){return e(t,n,c)}))}):Promise.reject("NetworkError: "+r.status)})},r=function(t,e){var n=e.filter(function(e){return!i("medium",t,e)});return 0===n.length?Promise.resolve(s.getData("medium",t)):fetch(o.constructIdNewsUrl("medium",t,n),c).then(function(e){return e.ok?e.json().then(function(e){return 1===e.count?(s.pushCacheData("medium",e.data[0]),Promise.resolve(s.getData("medium",t))):Promise.reject(new Error("[getMediumById] get "+e.count+" data"))}):Promise.reject(new Error("[getMediumById] "+e.status))})},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=arguments[1];if(s.cache.medium.recent.length<t)return console.log("[getMediumRecent] fetching"),fetch(o.constructRecentMedium(t,["id"]),c).then(function(t){return t.ok?t.json().then(function(t){t.data.map(function(t){return t._id}).forEach(function(t){return s.pushOtherRecent("medium",t)});var n=s.cache.medium.recent;return Promise.all(n.map(function(t){return r(t,e)}))}):Promise.reject("NetworkError: "+t.status)});var n=s.cache.medium.recent;return Promise.all(n.map(function(t){return r(t,e)}))},l=function(t,e){var n=e.filter(function(e){return!i("mbook",t,e)});return 0===n.length?Promise.resolve(s.getData("mbook",t)):fetch(o.constructIdNewsUrl("mbook",t,n),c).then(function(e){return e.ok?e.json().then(function(e){return 1===e.count?(s.pushCacheData("mbook",e.data[0]),Promise.resolve(s.getData("mbook",t))):Promise.reject(new Error("[getMBookById] get "+e.count+" data"))}):Promise.reject(new Error("[getMBookById] "+e.status))})};return{getNewsRecent:t,getNewsById:e,getNewsByTag:n,getMediumById:r,getMediumRecent:u,getMBookById:l,getMBookRecent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=arguments[1],n=s.cache.mbook.recent.length,r=s.cache.mbook.recent;return n<t?fetch(o.constructRecentNewsUrl("mbook",null,t,["id"]),c).then(function(t){return t.ok?t.json().then(function(t){t.data.map(function(t){return t._id}).forEach(function(t){return s.pushOtherRecent("mbook",t)});var n=s.cache.mbook.recent;return Promise.all(n.map(function(t){return l(t,e)}))}):Promise.reject("NetworkError: "+t.status)}):Promise.all(r.map(function(t){return l(t,e)}))}}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.constructImgUrl=e.constructIdMedium=e.constructRecentMedium=e.constructTagNewsUrl=e.constructIdNewsUrl=e.constructRecentNewsUrl=void 0;var r=n(2);e.constructRecentNewsUrl=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,o=arguments[3],c="http://"+r.domain+t+"/recent?";return c=c+(e?"tag="+e+"&":"")+(o?"fields="+o.join(",")+"&":"")+"count="+n},e.constructIdNewsUrl=function(t,e,n){var o="http://"+r.domain+t+"/id-"+e+"?";return o+=n?"fields="+n.join(","):""},e.constructTagNewsUrl=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,o=arguments[3],c="http://"+r.domain+t+"/tag-"+e+"?";return c=c+(o?"fields="+o.join(",")+"&":"")+"count="+n},e.constructRecentMedium=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,e=arguments[1],n="http://"+r.domain+"medium/recent?";return n=n+(e?"fields="+e.join(",")+"&":"")+t},e.constructIdMedium=function(t,e){var n="http://"+r.domain+"medium/id-"+t;return n+=e?"fields="+e.join(",")+"&":""},e.constructImgUrl=function(t){return"http://"+r.host+":"+r.port+"/static/images/"+t+".jpg"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=(e.NewsTags=["politics","china","tech","business","life"],e.NewsListItemFields=["id","title","image_urls","tag","summary"],e.AllNewsFields=["id","title","url","timestamp","crawled_at","summary","image_urls","text","tag","source"],e.AllBlogFields=["id","title","url","crawled_at","image_urls","text","summary"],e.Tags={bbc:["china","politics","asia","business","tech","entertainment","health"],cnn:["china","business","entertainment","politics","tech","sport","life","health"],reuters:["china","business","politics","tech","life","entertainment","art","sport"]},e.host="139.224.118.55"),o=e.port="3002";e.domain=r+":"+o+"/api/v1/"}]);